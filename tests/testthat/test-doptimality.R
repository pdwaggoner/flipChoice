d0.design <- structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11,
                         12, 12, 13, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 1, 2,
                         1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1,
                         2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 3, 3,
                         2, 4, 1, 4, 2, 1, 3, 3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 4, 2,
                         1, 2, 2, 1, 4, 3, 1, 1, 1, 1, 1, 3, 2, 1, 4, 1, 1, 1, 1, 3, 4,
                         1, 3, 4, 2, 3, 4, 2, 4, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2,
                         4, 2, 3, 2), .Dim = c(36L, 8L),
                       .Dimnames = list(NULL, c("Version", "Question", "Alternative",
                                                "Att1", "Att2", "Att3", "Att4", "Att5")))

dp.design <- structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11,
                         12, 12, 13, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 1, 2,
                         1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1,
                         2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1,
                         1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 4, 3, 1,
                         1, 4, 2, 2, 3, 1, 1, 1, 4, 2, 3, 4, 3, 3, 1, 1, 1, 2, 1, 4, 3,
                         1, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 4, 4, 3, 2, 1, 1, 1, 3, 4, 2,
                         1, 1, 1, 1, 3, 1, 1, 1, 1, 4, 3, 2, 1, 3, 1, 1, 1, 1, 2, 1, 1,
                         4, 2, 3, 2), .Dim = c(36L, 8L),
                       .Dimnames = list(NULL, c("Version", "Question", "Alternative",
                                                "Att1", "Att2", "Att3", "Att4", "Att5")))

db.design <- structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3,
            3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 9, 10,
            10, 10, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3,
            1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 5, 3, 5, 1, 4, 5, 2, 3,
            2, 4, 1, 3, 2, 1, 1, 2, 3, 5, 1, 4, 1, 4, 2, 1, 4, 3, 5, 1, 2,
            1, 2, 4, 3, 2, 1, 4, 3, 1, 3, 3, 1, 3, 1, 2, 1, 4, 2, 1, 4, 3,
            3, 4, 1, 4, 2, 1, 1, 3, 2), .Dim = c(30L, 5L), .Dimnames = list(
                NULL, c("Version", "Question", "Alternative", "price", "time")))

test_that("D_0-optimality", {
    expect_equal(DOptimality(d0.design),  1.22245332640841)
})


test_that("D_P-optimality", {
    expect_equal(DOptimality(dp.design,
                             prior = c(1, -1, 1, 0, 1, 2, 0, -1, -2)),
                 -1.03396669554188)
})

test_that("D_B-optimality", {
    prior <- structure(c(0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2),
                       .Dim = c(7L, 2L))
    expect_equal(DOptimality(db.design, prior = prior, seed = 1),
                 -6.30145393214796)
})

